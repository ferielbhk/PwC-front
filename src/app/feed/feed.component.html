<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- IconScout CDN -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v2.1.6/css/unicons.css">
    <!-- Stylesheet -->
  
</head>
<style>
    .body-content{
        margin-top: 6rem;
    }
</style>
<nav class="navbar px-5 nav bg-white fixed-top">
  <div class="container-fluid ">
    <div>
      <a class="navbar-brand d-flex align-items-center">
        <img src="../assets/pwc-connect-removebg-preview.png" class="img-fluid" alt="">
        
      </a>
    </div>

    <div class="container">
      <div class="form-group ">
        <input type="text" class="form-control" placeholder="Search" aria-label="Search"
        [(ngModel)]="searchQuery" (input)="filterUsers()">
      </div>
      <ul class="list-group" *ngIf="filteredUsers.length > 0">
        <li *ngFor="let user of filteredUsers" class="list-group-item mb-2 mt-2">
          <div class="d-flex align-items-center">
            <img [src]="'data:image/png;base64,'+user?.image " class="rounded-circle mx-2" alt="Profile" style="width: 40px; height: 40px;">
            <div>
              <span class="font-weight-bold d-lg-inline ">{{user?.firstname}} {{user?.lastname}}</span>
              <button class="btn btn-primary  mx-4 px-4" (click)="handleButtonClick(user)">Contacter</button>

            </div>
          </div>
        </li>
      </ul>
     
    </div>
     <div>
      <button type="button" class="btn btn-danger" (click)="signOff()"><i class="fa fa-solid fa-power-off"></i></button>
     </div>
  </div>
</nav>
<body>
        <div class="body-content   background-color:grey px-5 mx-5">
          <main >
              <div class=" containeeerrr ">
                  <section class="left px-4 mx-4">
                     <div class="sidebar">
    <a class="menu-item active" href="#">
      <span><i class="uil uil-home"></i></span>
      <h3>Home</h3>  
    </a>
  
    
    <a class="menu-item" id="messagesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <span class="position-relative">
        <i class="uil uil-envelope-alt"></i>
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger badge-notification">
          {{ unreadMessages }}
        </span>
      </span>
      <h3 routerLink="/chat">Messages</h3>
    </a>

    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="messagesDropdown">
      <li *ngFor="let message of notificationsMessages">
        <a *ngIf="!message.read" class="dropdown-item d-flex align-items-center" routerLink="/chat" (click)="makeitRead(message)">
          <div class="icon-message me-2">
            <i class="bi bi-chat-dots-fill"></i>
          </div>
          <div >
            <p class="mb-0 text-muted">{{ message.message}}</p>
            <p><small>{{ message.timestamp | date: 'MMM dd, yyyy à HH:mm' }}</small></p>
          </div>
        </a>
      </li>
      <li>
        <a class="dropdown-item text-center" (click)="viewAllNotifications()">
          View all messages
        </a>
      </li>
    </ul>
    
    <!-- Dropdown Trigger -->
<div class="position-relative">
  <a class="menu-item hh d-flex align-items-center" href="#" id="notificationDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="me-2"><i class="uil uil-bell"></i></span>
    <span class="d-flex flex-column">
      <span><h3>Notifications</h3></span>
      <span class="position-absolute">
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger badge-notification">
          {{ unreadCount }}
          <span class="visually-hidden">unread notifications</span>
        </span>
      </span>
    </span>
  </a>

  <!-- Dropdown Menu -->
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationDropdown">
    <li *ngFor="let notif of notifications">
      <div class="dropdown-item d-flex align-items-center notification-item" (click)="markAsRead(notif)">
        <div class="icon-bell me-2">
          <i class="bi bi-bell-fill"></i>
        </div>
        <div>
          <p class="mb-0 text-muted">{{ notif.message }}</p>
          <p><small>{{ notif.timestamp | date: 'MMM dd, yyyy à HH:mm' }}</small></p>
        </div>
      </div>
    </li>
    <li>
      <a class="dropdown-item text-center" (click)="viewAllNotifications()">
        View all notifications
      </a>
    </li>
  </ul>
</div>

    <a class="menu-item" routerLink="/members">
      <span><i class="uil uil-user"></i></span>
      <h3>PWC's members</h3>
    </a>
  </div>  
  
            </section>
            <!----------------- MIDDLE -------------------->
            <section class="middle mb-4">
             
                <!----------------- POSTS -------------------->
                <div class="feeds">
                  <app-stories class="d-flex"></app-stories>
                  <form  (ngSubmit)="onSubmit()" enctype="multipart/form-data"  class="feed">
                    <div class="d-flex align-items-center">
                      <img [src]="'data:image/png;base64,'+user.image " class="rounded-circle mx-2" alt="Profile" style="width: 70px; height: 70px;">
                      <h6><span class="font-weight-bold d-lg-inline ">{{user.firstname}} {{user.lastname}}</span></h6>
                  </div>
                     
                      <div class="form-group mt-2">
                        <input id="content"[(ngModel)]="content" name="content"   placeholder="WHAT'S ON YOUR MIND ?"  class="form-control inputpost mb-2 " required>            
                        <input type="file" id="image" (change)="onFileSelected($event)" class="form-control w-50 h-50" >
                      </div>
                      <button type="submit" class="btn btn-primary mt-3">Post</button>
                   
                  </form>
                  <div class="feed mb-3 py-2" *ngFor="let post of posts; let i = index">
                    <div class="post-card">
                      <div class="head">
                        <div class="user">
                          <div class="profile-photo mt-1">
                            <img [src]="'data:image/png;base64,'+post.user.image " class="rounded-circle mx-2" alt="Profile" style="width: 40px; height: 40px;">
                          </div>
                          <h6 class="mt-3">{{ post?.user?.firstname }} {{post?.user?.lastname}}</h6>
                          <div class="info"></div>
                        </div>
                        <span class="edit">
                          <i class="uil uil-ellipsis-h"></i>
                        </span>
                      </div>
                      <div class="content">
                        <p>{{ post?.content }}</p>
                        <img *ngIf="post?.image" [src]="'data:image/png;base64,' + post.image" >
                    </div>
                      <div class="action-buttons">
                        <div class="interaction-buttons">
                          <span class="liked-by"></span>
                          <span><fa-icon (click)="toggleLike(post)"
                            [icon]="post.isLiked ? faHeartSolid : faHeartOutline"  class="heart-icon"   [ngClass]="{ liked: post.isLiked }"  ></fa-icon> </span>
                          <span><i (click)="handleButtonClick(post.user)" class="uil uil-comment-dots"></i></span>
                        </div>
                      </div>
                      <div class="liked-by">
                        {{ post.likes }} Likes  ~  {{post.commentaires}} Comments</div>
                        <div class="form-group mt-2">
                          <input [(ngModel)]="post.currentComment" (keyup)="testme(i)" placeholder="COMMENT THIS POST ?" class="form-control" required>
                          <button (click)="createComment(post.id)" class="btn btn-primary mt-3 mb-3">Comment</button>
                        </div>
                      <div>
                        <div class="comment ">
                          <div class="commentairee my-2 rounded" *ngFor="let commentt of post.comments">
                            <div class="d-flex align-items-center py-1">
                                <img [src]="'data:image/png;base64,'+commentt.user.image " class="rounded-circle mx-2" style="width: 40px; height: 40px;">
                                <h6 class="my-1 " style="color: rgb(255, 94, 0)" >{{ commentt.user.firstname }} {{commentt.user.lastname}}</h6>                    
                            </div>
                            <div class=" mx-2" style="color: rgb(6, 6, 7)">
                              <p>{{ commentt.content }}</p> 
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
            </section>
             <!----------------- END OF MIDDLE -------------------->
            <!----------------- RIGHT -------------------->
            <section class="right px-4 mx-4">
                               
                  <div class="friend-requests">
                    <div class="request">
                      <div class="info align-items-center justify-content-center">
                        <div class="profile-photo">
                          <img [src]="'data:image/png;base64,'+user.image" class="rounded-circle mx-2" alt="Profile" style="width: 40px; height: 40px;" >
                        </div>
                        <div>
                          <h5>{{user.firstname}} {{user.lastname}}</h5>
                        </div>
                      </div>
                      <hr>
                      <div class="details">
                        <div class="info-item">
                          <i class="fas fa-envelope"></i>
                          <h5>Email: {{user.email}}</h5>
                        </div>
                        <div class="info-item">
                          <i class="fas fa-phone"></i>
                          <h5>Phone number: {{user.tel}}</h5>
                        </div>
                        <div class="info-item">
                          <i class="fas fa-info-circle"></i>
                          <h5>Informations: {{user.informations}}</h5>
                        </div>
                      </div>
                      <hr>
                      <div class="action-container">
                        <button class="action btn btn-primary" (click)="routerr()" >
                          More
                        </button>
                      </div>
                    </div>
                  </div>
        
                
            </section>
            <!----------------- END OF RIGHT -------------------->
        </div>
    </main>
 
    <!----------------- THEME CUSTOMIZATION -------------------->
    <div class="customize-theme">
        <div class="card">
            <h2>Customize your view</h2>
            <p class="text-muted">Manage your font size, color, and background</p>
 
            <!----------- FONT SIZE ----------->
            <div class="font-size">
                <h4>Font Size</h4>
                <div>
                    <h6>Aa</h6>
                    <div class="choose-size">
                        <span class="font-size-1"></span>
                        <span class="font-size-2 active"></span>
                        <span class="font-size-3"></span>
                        <span class="font-size-4"></span>
                        <span class="font-size-5"></span>
                    </div>
                    <h3>Aa</h3>
                </div>
            </div>
 
            <!----------- PRIMARY COLORS ----------->
            <div class="color">
                <h4>Color</h4>
                <div class="choose-color">
                    <span class="color-1 active"></span>
                    <span class="color-2"></span>
                    <span class="color-3"></span>
                    <span class="color-4"></span>
                    <span class="color-5"></span>
                </div>
            </div>
 
            <!----------- BACKGROUND COLORS ----------->
            <div class="background">
                <h4>Background</h4>
                <div class="choose-bg">
                    <div class="bg-1 active">
                        <span></span>
                        <h5 for="bg-1">Light</h5>
                    </div>
                    <div class="bg-2">
                        <span></span>
                        <h5 for="bg-2">Dim</h5>
                    </div>
                    <div class="bg-3">
                        <span></span>
                        <h5 for="bg-3">Dark</h5>
                    </div>
                </div>
            </div>
       
    </div>
    </div>
    </div>
</body>
</html>
